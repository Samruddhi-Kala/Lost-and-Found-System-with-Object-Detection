{% extends "base.html" %}

{% block content %}
<div class="form-container">
  <div class="form-header">
    <div class="form-icon success">
      <i class="ri-hand-heart-line"></i>
    </div>
    <h1>Report Found Item</h1>
    <p>Help someone find their lost belongings by reporting what you found</p>
  </div>

  <form method="POST" enctype="multipart/form-data" class="enhanced-form">
    <div class="form-group">
      <label class="form-label">
        <i class="ri-file-text-line"></i>
        Description *
      </label>
      <textarea 
        name="description" 
        class="form-input" 
        required 
        rows="4"
        placeholder="Describe the found item in detail (color, brand, condition, where you found it, etc.)"
      ></textarea>
      <small class="form-help">Include specific details to help owners identify their items</small>
    </div>
    
    <div class="form-group">
      <label class="form-label">
        <i class="ri-folder-line"></i>
        Category *
      </label>
      <div class="select-wrapper">
        <select name="category" class="form-input" required>
          <option value="">Select a category</option>
          <option value="electronics">ðŸ“± Electronics (Phone, Laptop, Tablet, etc.)</option>
          <option value="clothing">ðŸ‘• Clothing (Jacket, Hat, Scarf, etc.)</option>
          <option value="accessories">ðŸ‘œ Accessories (Bag, Wallet, Keys, etc.)</option>
          <option value="documents">ðŸ“„ Documents (ID, Passport, Papers, etc.)</option>
          <option value="other">ðŸ“¦ Other</option>
        </select>
        <i class="ri-arrow-down-s-line select-icon"></i>
      </div>
    </div>

    <div class="form-group">
      <label class="form-label">
        <i class="ri-image-line"></i>
        Image *
      </label>
      <div class="file-upload-wrapper">
        <input 
          type="file" 
          name="image" 
          id="image-upload"
          accept="image/*"
          class="file-input"
          required
        >
        <label for="image-upload" class="file-upload-label">
          <div class="upload-content">
            <i class="ri-upload-cloud-2-line"></i>
            <span class="upload-text">Click to upload or drag and drop</span>
            <span class="upload-hint">PNG, JPG, or JPEG (Max 8MB) - Required</span>
          </div>
        </label>
        <div id="image-preview" class="image-preview"></div>
      </div>
      <small class="form-help">A clear photo is required for our AI to identify the item</small>
    </div>

    <div class="form-actions">
      <button type="button" onclick="window.history.back()" class="button button-outline">
        <i class="ri-arrow-left-line"></i>
        Cancel
      </button>
      <button type="submit" class="button button-primary">
        <i class="ri-send-plane-line"></i>
        Submit Report
      </button>
    </div>
  </form>

  <div class="form-footer">
    <div class="info-box success">
      <i class="ri-information-line"></i>
      <div>
        <strong>Thank you for helping!</strong>
        <p>Your kindness helps reunite people with their belongings. Our AI will analyze the item and search for potential owners.</p>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// Enhanced file upload preview
document.addEventListener('DOMContentLoaded', () => {
  const fileInput = document.getElementById('image-upload');
  const preview = document.getElementById('image-preview');
  const uploadLabel = document.querySelector('.file-upload-label');
  
  if (fileInput) {
    fileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = (e) => {
          preview.innerHTML = `
            <div class="preview-image-container">
              <img src="${e.target.result}" alt="Preview">
              <button type="button" class="remove-image" onclick="removeImage()">
                <i class="ri-close-circle-line"></i>
              </button>
              <div class="file-info">
                <i class="ri-file-image-line"></i>
                <span>${file.name}</span>
              </div>
            </div>
          `;
          uploadLabel.style.display = 'none';
          preview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      }
    });
  }
});

function removeImage() {
  const fileInput = document.getElementById('image-upload');
  const preview = document.getElementById('image-preview');
  const uploadLabel = document.querySelector('.file-upload-label');
  
  fileInput.value = '';
  preview.innerHTML = '';
  preview.style.display = 'none';
  uploadLabel.style.display = 'flex';
}
</script>
{% endblock %}
